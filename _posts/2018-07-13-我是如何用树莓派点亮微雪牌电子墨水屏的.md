---
layout: post
title: 我是如何用树莓派点亮微雪牌电子墨水屏的
date: 2018-07-13 03:27 +0800
image:
tags:
- 生活
---

几个月之前买到了树莓派3B+和微雪的7.5英寸电子墨水屏。
一直想组装起来，结果因为网上杂乱的教程大敲退堂鼓，一直拖到昨天才成功安装上。
如果你在找一篇入门教程，并且对组装硬件、准备环境之类的基础内容感兴趣，那么这篇文章可能会帮到你！

# 涉及的硬件
 
- 树莓派 Model 3B+
- 微雪电子墨水屏 7.5inch e-Paper
- 微雪电子墨水屏模块（HAT） 7.5inch e-Paper HAT

# 硬件安装

## 树莓派和HAT

重点：HAT板上的字和树莓派板上的字要相反，才是正确的安装方向！
方向弄对之后，把两者的GPIO脚对准插上就可以了。

吃了大亏……

关于HAT上的两个小开关：
左边的开关根据屏幕的尺寸选择即可。
至于右边……用了四线SPI是没问题的……

## HAT和屏幕

类似树莓派上的Camera接口，只需要把HAT上的口打开（把两边往上提），把屏幕下方的薄片插进去之后关好口子（把两边往下按）就行。
至于方向，只要屏幕正面和HAT板正面都朝上就行，或者说，屏幕下方薄片带金属条的一面和HAT板正面都朝上就好。

# 软件安装

我进行软件安装的所有过程都是通过远程桌面实现的，关于这部分的技术细节就不展开啦。
此处假设你已经成功地在树莓派上运行着Raspbian系统，并且能够访问系统进行操作~

首先启动Terminal，更新软件：

```
sudo apt-get update
sudo apt-get upgrade
```

第二步，开启树莓派默认关闭的SPI和I2C功能。
参考：[树莓派入门教程——开启SPI和I2C功能](http://www.landzo.cn/thread-12826-1-1.html)（链接已经挂了……有需要的朋友自行谷歌吧）
 
```
sudo raspi-config

```
在Interfacing Options 中找到SPI和I2C，把它们打开就好。

之后根据[微雪官方提供的教程](https://www.waveshare.net/study/article-742-1.html)分别安装好`wiringPi`, `bcm2835`, 和Python库。
小小地怀疑一下，似乎这三个库是三种不同的途径，实际上我们不需要安装所有的三个库？
从简单程度上来说，似乎`bcm2835`是最优解。因为`wiringPi`和Python库在安装之后都会在后面遇到一些小麻烦。

不得不说微雪课堂真的非常良心，这是一个系列，其他部分也能学到非常多。
 
库准备好之后，在官方的资料下载中心找到示例程序。
下载后根据用户手册中的描述操作就能运行啦！

实际上到这一步，`wiringPi`和`bcm2835`文件夹中的例程应该都能顺利运行了，但是python的例程还需要一点小处理。
参考：[python提示ImportError: No module named Image](https://blog.csdn.net/weixin_40013463/article/details/79424403)

需要在`python`文件夹，所有`.py`文件中把`Image`相关的项目（注意区分大小写）替换为`PIL.Image`。如果原来的代码中`Image`之后有内容，则替换时要保留。比如`ImageDraw`要替换为`PIL.ImageDraw`。

这下，应该就可以玩转墨水屏了！

最后是一点简单的探索：
通过更改`monocolor.bpm`文件，就能够让墨水屏在最后显示不同的画面！